<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">



  <meta name="description" content="抓抓包"/>













  <link rel="alternate" href="/atom.xml" title="farwmarth">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.6.0" />



<link rel="canonical" href="http://www.farwmarth.com/抓抓包/"/>


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.6.0" />






  



  <script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>









    <title> 抓抓包 - farwmarth </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">farwmarth</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/about">
        <li class="mobile-menu-item">
          
          
            关于
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            归档
          
        </li>
      </a>
    
      <a href="/tags">
        <li class="mobile-menu-item">
          
          
            标签
          
        </li>
      </a>
    
      <a href="/categories">
        <li class="mobile-menu-item">
          
          
            分类
          
        </li>
      </a>
    
      <a href="/douban">
        <li class="mobile-menu-item">
          
          
            豆瓣
          
        </li>
      </a>
    
      <a href="/music">
        <li class="mobile-menu-item">
          
          
            音乐
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">farwmarth</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            
            
              关于
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              归档
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            
            
              标签
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/categories">
            
            
              分类
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/douban">
            
            
              豆瓣
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/music">
            
            
              音乐
            
          </a>
        </li>
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          抓抓包
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2013-08-23
        </span>
        
          <div class="post-category">
            
              <a href="/categories/破解/">破解</a>
            
          </div>
        
        
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#WPE-PRO"><span class="toc-text">WPE PRO</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WSExplorer"><span class="toc-text">WSExplorer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Wireshark"><span class="toc-text">Wireshark</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#先来看看过滤器-过滤器分两种"><span class="toc-text">先来看看过滤器,过滤器分两种</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#开始抓包"><span class="toc-text">开始抓包</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#其他工具"><span class="toc-text">其他工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#android-抓包"><span class="toc-text">android 抓包</span></a></li></ol>
    </div>
  </div>


    <div class="post-content">
      
        <h2 id="WPE-PRO"><a href="#WPE-PRO" class="headerlink" title="WPE PRO"></a><a href="http://wpepro.net/" target="_blank" rel="noopener">WPE PRO</a></h2><p>基于进程的抓包工具.强大的网络封包编辑器，wpe可以截取网络上的信息，修改封包数据，是外挂制作的常用工具</p>
<p>还没研究怎么弄外挂，先拿来看看软件的get,post数据.如七色追剧助手。<br><a id="more"></a><br><img src="http://farwmarth.bestnewbee.com/images/uploads/2013/08/image13.png" alt="image"></p>
<p>Target program : 选择要抓的进程,然后点黑色箭头就可以启动抓包了。</p>
<p>软件发送网络请求后，停止抓包，可以看到一些数据:</p>
<p><img src="http://farwmarth.bestnewbee.com/images/uploads/2013/08/image14.png" alt="image"></p>
<p><img src="http://farwmarth.bestnewbee.com/images/uploads/2013/08/image15.png" alt="image"></p>
<p>可以看到请求的资源和参数。以及返回.这样相当我们可以拿到一个api.如下:</p>
<p><a href="http://www.7se.com/sp?username=dd&amp;keyWord=%E6%81%A9%E8%B5%90%E4%B9%8B%E5%9C%B0" target="_blank" rel="noopener">http://www.7se.com/sp?username=dd&amp;keyWord=%E6%81%A9%E8%B5%90%E4%B9%8B%E5%9C%B0</a></p>
<h2 id="WSExplorer"><a href="#WSExplorer" class="headerlink" title="WSExplorer"></a>WSExplorer</h2><h2 id="Wireshark"><a href="#Wireshark" class="headerlink" title="Wireshark"></a><a href="http://www.wireshark.org/download.html" target="_blank" rel="noopener">Wireshark</a></h2><p>基于网卡的封包工具.是一个网络封包分析软件,winreshark并非一个入侵软件.wireshark的开发简史也有点意思,原名为Ethereal,他妈人为GeraldCombs,97年开始开发，中断过几次开发后，在98年发了每一版本，然后combs收到世界各地的修补程式和建议，陆续有很多人参与开发，包括教师等超过千人参与过开发，后因商标问题更名为wireshark.从图标可以看出是一只鲨鱼的背鳍。呃，废话太多了。。</p>
<h3 id="先来看看过滤器-过滤器分两种"><a href="#先来看看过滤器-过滤器分两种" class="headerlink" title="先来看看过滤器,过滤器分两种"></a>先来看看过滤器,过滤器分两种</h3><ul>
<li><strong>捕捉过滤器(CaptureFilter):控制捕捉的数据大小</strong></li>
</ul>
<p><img src="http://farwmarth.bestnewbee.com/images/uploads/2013/08/image16.png" alt="image"></p>
<ul>
<li>Protocol(协议): 可能的值ether, fddi, ip, arp, rarp, decnet, lat, sca, moprc, mopdl, tcp ,udp</li>
<li>Direction(方向):可能的值: src(源), dst(目的), src and dst, src or dst</li>
<li>Host(s):可能的值:net, port(端口), host(ip), portrange</li>
<li>Logical Operations(逻辑运算):not ,and,or</li>
</ul>
<p>例子:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tcp dst port 8080 目的tcp端口为8080的封包</span><br><span class="line">dst host 42.121.110.83 目的ip为42.121.110.83的封包</span><br><span class="line">ether host e0-05-c5-44-b1-3c 捕捉此mac地址的封包</span><br><span class="line">src portrange 2000-2500 来源在此端口范围的封包</span><br><span class="line">dst host 42.121.110.83 and dst port 8080 目的ip为42.121.110.83,端口为8080的封包</span><br><span class="line">http &amp;&amp; ip.dst == 45.32.254.126</span><br></pre></td></tr></table></figure></p>
<ul>
<li>显示过滤器(DisplayFilter): 定位和缩小数据</li>
</ul>
<p><img src="http://farwmarth.bestnewbee.com/images/uploads/2013/08/image17.png" alt="image"></p>
<p>Comparison operators （比较运算符）:</p>
<p><img src="http://farwmarth.bestnewbee.com/images/uploads/2013/08/image18.png" alt="image"></p>
<p>例子:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ip.addr == 10.1.1.1 //显示来源或目的IP地址为10.1.1.1的封包。</span><br><span class="line">ip.src != 10.1.2.3 or ip.dst != 10.4.5.6 //显示来源不为10.1.2.3或者目的不为10.4.5.6的封包。</span><br><span class="line">tcp.port == 25 //显示来源或目的TCP端口号为25的封包。</span><br><span class="line">tcp.dstport == 25 //显示目的TCP端口号为25的封包。</span><br></pre></td></tr></table></figure></p>
<p><img src="http://farwmarth.bestnewbee.com/images/uploads/2013/08/image19.png" alt="image"></p>
<p>表达式正确背景为绿色，错误会为红色.</p>
<h4 id="开始抓包"><a href="#开始抓包" class="headerlink" title="开始抓包"></a>开始抓包</h4><p><img src="http://farwmarth.bestnewbee.com/images/uploads/2013/08/image20.png" alt="image"></p>
<p>捕捉时要选择指定的网上，可以指定捕捉过滤器，我这里还是拿七色追剧助手为便，这个过滤器的意思是目的地址ip为112.82.244.196的封包. 如果要把抓取的包数据保存成文件，可以填写caputure files. 点击start开始抓包。</p>
<p><img src="http://farwmarth.bestnewbee.com/images/uploads/2013/08/image21.png" alt="image"></p>
<p>tcp的三次握手</p>
<p><strong>1. (Client) –&gt; [SYN] –&gt; (Server)</strong></p>
<p>假如Client和Server通讯. 当Client要和Server通信时，Client首先向Server发一个SYN (Synchronize) 标记的包，告诉Server请求建立连接.</p>
<p>注意: 一个 SYN包就是仅SYN标记设为1的TCP包(参见TCP包头Resources). 认识到这点很重要，只有当Server收到Client发来的SYN包，才可建立连接，除此之外别无他法。因此，如果你的防火墙丢弃所有的发往外网接口的SYN包，那么你将不 能让外部任何主机主动建立连接。</p>
<p><strong>2. (Client) &lt;– [SYN/ACK] &lt;–(Server)</strong></p>
<p>接着，Server收到来自Client发来的SYN包后，会发一个对SYN包的确认包(SYN/ACK)给Client，表示对第一个SYN包的确认，并继续握手操作.</p>
<p>注意: SYN/ACK包是仅SYN 和 ACK 标记为1的包.</p>
<p><strong>3. (Client) –&gt; [ACK] –&gt; (Server)</strong></p>
<p>Client收到来自Server的SYN/ACK 包,Client会再向Server发一个确认包(ACK)，通知Server连接已建立。至此，三次握手完成，一个TCP连接完成。</p>
<p>Note: ACK包就是仅ACK 标记设为1的TCP包. 需要注意的是当三此握手完成、连接建立以后，TCP连接的每个包都会设置ACK位</p>
<p><img src="http://farwmarth.bestnewbee.com/images/uploads/2013/08/image22.png" alt="image"></p>
<p>和WPE PRO，get数据差不多。包数据更详细，有载入的时间等等。</p>
<h2 id="其他工具"><a href="#其他工具" class="headerlink" title="其他工具"></a>其他工具</h2><ul>
<li><a href="http://freecap.ru/eng/" target="_blank" rel="noopener">http://freecap.ru/eng/</a> :可以把不支持socks代理的软件通过freecap设置的socks代理连接到外网</li>
<li>httptunnel<br>HttpTuunnel(也叫Http隧道，Http穿梭），是这样一种技术:它用HTTP协议在要通信的Client和Server建立起一条”Tunnel”，然后Client和Server之间的通信，都是在这条Tunnel的基础之上。</li>
</ul>
<p>HttpTunnel通常被用在受限的网络环境中，比如在NAT环境中的Client，受防火墙限制的环境中的Client等，在这样的环境中，Client不能直接连接到公网(WAN)的Server，这时候就可以通过HttpTunnel技术，来解决上述问题。<br><a href="http://www.wuzesheng.com/?p=2168" target="_blank" rel="noopener">http://www.wuzesheng.com/?p=2168</a></p>
<ul>
<li>WinPcap</li>
</ul>
<h2 id="android-抓包"><a href="#android-抓包" class="headerlink" title="android 抓包"></a>android 抓包</h2><p>工具:android内核基于linux,linux包分析工具<a href="http://www.strazzere.com/android/tcpdump" target="_blank" rel="noopener">tcpdump</a>.<br>前提条件:手机已root.</p>
<ol>
<li>复制tcpdump到手机: adb push C:/tcpdump /data/local/tcpdump</li>
<li>修改tcpdump权限: chmod 777 /data/local/tcpdump</li>
<li>进入shell: adb shell</li>
<li>进入root: su</li>
<li>运行抓包到存储卡: /data/local/tcpdump -i any -p -s 0 -w /sdcard/capture.pcap</li>
<li>运行应用后按ctrl+c中断抓包.</li>
<li>将抓包结果复制到本地: adb pull /sdcard/capture.pcap c:/</li>
<li>使用Wireshark等工具查看抓包文件capture.pcap<br>例: /data/local/tcpdump -w /sdcard/target.pcap host 192.169.1.1 and port 10000 ip 为192.169.1.1端口为10000的数据包保存到文件target.pcap.<br><p> /data/local/tcpdump -X -nn host 10.1.1.253</p></li>
</ol>
<p>##Charles</p>
<p>##Http Analyzer</p>
<p>##Fiddler</p>
<p>##Network Monitor</p>
<p>##Packet Capture</p>
<p>##bitshark</p>
<p>##网络嗅探Wi.cap</p>

      
    </div>

    
      
      



      
      
  <div class="post-reward">
    <input type="checkbox" name="reward" id="reward" hidden />
    <label class="reward-button" for="reward">赞赏支持</label>
    <div class="qr-code">
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="/image/reward/wechat.png" title="wechat">
        </label>
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="/image/reward/alipay.png" title="alipay">
        </label>
      
    </div>
  </div>

    

    
      <footer class="post-footer">
        
        
        
  <nav class="post-nav">
    
      <a class="prev" href="/cocos2d-x 骨骼动画/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">cocos2d-x 骨骼动画</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    
    
      <a class="next" href="/a星初探/">
        <span class="next-text nav-default">a* 初探</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
  </div>


        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:wujiyu115@email.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a href="http://github.com/wujiyu115" class="iconfont icon-github" title="github"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a href="/farwmwarth" class="iconfont icon-instagram" title="instagram"></a>
        
      
    
    
    
      <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>


<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2011 - 
    
    2018

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">farwmarth</span>
  </span>
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  
  

  



    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  


    <script type="text/javascript" src="/js/src/even.js?v=2.6.0"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.6.0"></script>

  </body>
</html>
