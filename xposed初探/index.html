<!DOCTYPE html>






  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.2.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.2.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.2.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="xposed 概念用一句话概念其牛b之处就是:可以hook到系统任意一个Java进程官方wiki: https://github.com/rovo89/XposedBridge/wiki  XposedInstaller，Xposed安装器,管理,下载,禁用Xposed Module,需要root权限。 Xposed，zygote的修改版.xposed实现的核心.这个zygote会替换系统原生的z">
<meta name="keywords" content="xposed">
<meta property="og:type" content="article">
<meta property="og:title" content="xposed初探">
<meta property="og:url" content="http://www.farwmarth.com/xposed初探/index.html">
<meta property="og:site_name" content="farwmarth">
<meta property="og:description" content="xposed 概念用一句话概念其牛b之处就是:可以hook到系统任意一个Java进程官方wiki: https://github.com/rovo89/XposedBridge/wiki  XposedInstaller，Xposed安装器,管理,下载,禁用Xposed Module,需要root权限。 Xposed，zygote的修改版.xposed实现的核心.这个zygote会替换系统原生的z">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-11-16T09:17:59.657Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="xposed初探">
<meta name="twitter:description" content="xposed 概念用一句话概念其牛b之处就是:可以hook到系统任意一个Java进程官方wiki: https://github.com/rovo89/XposedBridge/wiki  XposedInstaller，Xposed安装器,管理,下载,禁用Xposed Module,需要root权限。 Xposed，zygote的修改版.xposed实现的核心.这个zygote会替换系统原生的z">



  <link rel="alternate" href="/atom.xml" title="farwmarth" type="application/atom+xml" />




  <link rel="canonical" href="http://www.farwmarth.com/xposed初探/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>xposed初探 | farwmarth</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">farwmarth</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Those that can,do.Those that can't ,complain</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>




<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-douban">
    <a href="/douban" rel="section">
      <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />豆瓣</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-music">
    <a href="/music" rel="section">
      <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />网易云音乐</a>
  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.farwmarth.com/xposed初探/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="farwmarth">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="farwmarth">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">xposed初探
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建于：2016-04-22 19:10:39" itemprop="dateCreated datePublished" datetime="2016-04-22T19:10:39+08:00">2016-04-22</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="更新于：2017-11-16 17:17:59" itemprop="dateModified" datetime="2017-11-16T17:17:59+08:00">2017-11-16</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="xposed-概念"><a href="#xposed-概念" class="headerlink" title="xposed 概念"></a>xposed 概念</h2><p>用一句话概念其牛b之处就是:<code>可以hook到系统任意一个Java进程</code><br>官方wiki: <a href="https://github.com/rovo89/XposedBridge/wiki" target="_blank" rel="noopener">https://github.com/rovo89/XposedBridge/wiki</a></p>
<ul>
<li><a href="https://github.com/rovo89/XposedInstaller" target="_blank" rel="noopener">XposedInstaller</a>，Xposed安装器,管理,下载,禁用Xposed Module,需要root权限。</li>
<li><a href="https://github.com/rovo89/Xposed" target="_blank" rel="noopener">Xposed</a>，<code>zygote</code>的修改版.xposed实现的核心.这个zygote会替换系统原生的zygote。XposedInstaller会将它放到<code>/system/bin</code>目录下</li>
<li><a href="https://github.com/rovo89/XposedBridge" target="_blank" rel="noopener">XposedBridge</a>。java部分,编译出来是一个XposedBridge.jar包,写<code>hook</code>模块时使用.</li>
<li><a href="https://github.com/rovo89/XposedTools" target="_blank" rel="noopener">XposedTools</a>。帮助我们编译Xposed和XposedBridge。</li>
</ul>
<a id="more"></a>
<h2 id="xposed-原理"><a href="#xposed-原理" class="headerlink" title="xposed 原理"></a>xposed 原理</h2><h3 id="zygote-受精卵"><a href="#zygote-受精卵" class="headerlink" title="zygote (受精卵)"></a>zygote (受精卵)</h3><p><a href="http://blog.csdn.net/luoshengyang/article/details/6768304" target="_blank" rel="noopener">http://blog.csdn.net/luoshengyang/article/details/6768304</a><br><a href="http://www.cnblogs.com/innost/archive/2011/01/26/1945769.html" target="_blank" rel="noopener">http://www.cnblogs.com/innost/archive/2011/01/26/1945769.html</a><br>在Android系统中，所有的应用程序进程以及系统服务进程SystemServer都是由Zygote进程孕育（fork）出来的.<br>Android系统是基于Linux内核的，而在Linux系统中，所有的进程都是init进程的子孙进程，也就是说，所有的进程都是直接或者间接地由init进程fork出来的。Zygote进程也不例外，它是在系统启动的过程，由init进程创建的。在系统启动脚本system/core/rootdir/init.rc文件中.zygote进程要执行的程序是/system/bin/app_process</p>
<ol>
<li>系统启动时init进程会创建Zygote进程，Zygote进程负责后续Android应用程序框架层的其它进程的创建和启动工作。</li>
<li>Zygote进程会首先创建一个SystemServer进程，SystemServer进程负责启动系统的关键服务，如包管理服务PackageManagerService和应用程序组件管理服务ActivityManagerService。</li>
<li>当我们需要启动一个Android应用程序时，ActivityManagerService会通过Socket进程间通信机制，通知Zygote进程为这个应用程序创建一个新的进程</li>
</ol>
<h3 id="xposed-工作原理"><a href="#xposed-工作原理" class="headerlink" title="xposed 工作原理"></a>xposed 工作原理</h3><p>安装xposed框架时会把一个修改过的<code>zygote</code>版本安装到<code>system/bin</code> 中,当android系统启动时修改过的<code>zygote</code>在创建java虚拟机后,会调用<code>XposedBridgeApi.jar</code> 中的方法 来装载<code>Xposed module</code> .当执行一个android程序中的某一个方法 时,因为被xposed的<code>hookMethodNative</code>劫持,实际执行的是我们hook后的java代码.</p>
<h2 id="Xposed-module"><a href="#Xposed-module" class="headerlink" title="Xposed module"></a>Xposed module</h2><p>创建一个<code>Xposed module</code>和普通的anroid应用并没有什么 区别,不一样的是要在<code>AndroidManifest.xml</code> 加一些特殊的元数据<code>meta-data</code></p>
<h3 id="添加元数据"><a href="#添加元数据" class="headerlink" title="添加元数据"></a>添加元数据</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"> <span class="tag">&lt;<span class="name">manifest</span>  <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">package</span>=<span class="string">"com.far.xposedtest"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:versionCode</span>=<span class="string">"1"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:versionName</span>=<span class="string">"1.0"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-sdk</span> <span class="attr">android:minSdkVersion</span>=<span class="string">"15"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:icon</span>=<span class="string">"@drawable/ic_launcher"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:label</span>=<span class="string">"@string/app_name"</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:name</span>=<span class="string">"xposedmodule"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:name</span>=<span class="string">"xposeddescription"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:value</span>=<span class="string">"Easy example which makes the status bar clock red and adds a smiley"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:name</span>=<span class="string">"xposedminversion"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:value</span>=<span class="string">"30"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="实现模块接口"><a href="#实现模块接口" class="headerlink" title="实现模块接口"></a>实现模块接口</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> de.robv.android.xposed.mods.tutorial;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.IXposedHookLoadPackage;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.XposedBridge;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.callbacks.XC_LoadPackage.LoadPackageParam;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Tutorial</span> <span class="keyword">implements</span> <span class="title">IXposedHookLoadPackage</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleLoadPackage</span><span class="params">(<span class="keyword">final</span> LoadPackageParam lpparam)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        XposedBridge.log(<span class="string">"Loaded app: "</span> + lpparam.packageName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>log 定向到<code>/data/data/de.robv.android.xposed.installer/log/debug.log</code> .通过Xposed Installer可以读取 到查看程序log</p>
<h3 id="asserts中xposed-init-入口点声明"><a href="#asserts中xposed-init-入口点声明" class="headerlink" title="asserts中xposed_init 入口点声明"></a>asserts中xposed_init 入口点声明</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">de.robv.android.xposed.mods.tutorial.Tutorial</span><br></pre></td></tr></table></figure>
<h3 id="hook-a-method"><a href="#hook-a-method" class="headerlink" title="hook a method"></a>hook a method</h3><p><code>findAndHookMethod</code> 用于hook方法 ,在方法执行前后替换成我们的代码,官方教程是更改状态栏系统时钟的文字和颜色显示.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> de.robv.android.xposed.mods.tutorial;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> de.robv.android.xposed.XposedHelpers.findAndHookMethod;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.IXposedHookLoadPackage;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.XC_MethodHook;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.callbacks.XC_LoadPackage.LoadPackageParam;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Tutorial</span> <span class="keyword">implements</span> <span class="title">IXposedHookLoadPackage</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleLoadPackage</span><span class="params">(<span class="keyword">final</span> LoadPackageParam lpparam)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        <span class="comment">//判断 是不是要修改的系统UI</span></span><br><span class="line">        <span class="keyword">if</span> (!lpparam.packageName.equals(<span class="string">"com.android.systemui"</span>))</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="comment">//hook这个"updateClock" 方法,修改其文字和颜色</span></span><br><span class="line">        findAndHookMethod(<span class="string">"com.android.systemui.statusbar.policy.Clock"</span>, lpparam.classLoader, <span class="string">"updateClock"</span>, <span class="keyword">new</span> XC_MethodHook() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">beforeHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                <span class="comment">// this will be called before the clock was updated by the original method</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">afterHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                    TextView tv = (TextView) param.thisObject;</span><br><span class="line">                    String text = tv.getText().toString();</span><br><span class="line">                    tv.setText(text + <span class="string">" :)"</span>);</span><br><span class="line">                    tv.setTextColor(Color.RED);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Xposed-手册"><a href="#Xposed-手册" class="headerlink" title="Xposed 手册"></a>Xposed 手册</h2><h3 id="XposedBridge类"><a href="#XposedBridge类" class="headerlink" title="XposedBridge类"></a>XposedBridge类</h3><h4 id="log"><a href="#log" class="headerlink" title="log"></a>log</h4><p><code>log</code>方法用来捕获异常和打印信息,输出到标准logcat和<code>/data/xposed/debug.log</code>文件</p>
<h4 id="hookAllMethods-hookAllConstructors"><a href="#hookAllMethods-hookAllConstructors" class="headerlink" title="hookAllMethods / hookAllConstructors"></a>hookAllMethods / hookAllConstructors</h4><p>hook一个类中指定名字所有的方法 或者是构造函数.要注意的是如果在一个方法调用前后去拿方法参数,可能在 一些ROM里这个方法已经被别的程序hook过了.</p>
<h3 id="XposedHelpers类"><a href="#XposedHelpers类" class="headerlink" title="XposedHelpers类"></a>XposedHelpers类</h3><p>在eclipse中设置 Window =&gt; Preferences =&gt; Java =&gt; Editor =&gt; Content Assist =&gt; Favorites =&gt; New Type,输入：de.robv.android.xposed.XposedHelpers.这样eclipse在你开始输入“get…”时会自动提示这个类中的方法。</p>
<h4 id="findMethod-findConstructor-findField"><a href="#findMethod-findConstructor-findField" class="headerlink" title="findMethod / findConstructor / findField"></a>findMethod / findConstructor / findField</h4><p>这几个方法用来查找指定参数,名称的函数,构造器,和字段,而非反射方式：你可以用调用<code>findMethodBestMatch(Class&lt;?&gt; clazz, String methodName, Object... args)</code>,用来匹配相近的方法.</p>
<h4 id="callMethod-callStaticMethod-newInstance"><a href="#callMethod-callStaticMethod-newInstance" class="headerlink" title="callMethod / callStaticMethod / newInstance"></a>callMethod / callStaticMethod / newInstance</h4><p>利用上文提到的findXXX方法，可以用callxxx直接调用,或者用newInstance来构造 一个类实例。参数可以自动 匹配类型。如果你想明确的指定参数的类型，可以创建一个<code>Class&lt;?&gt;</code>数组，然后把它传递给callXXX/newInstance.你也可以参数数组都为null值，但是参数个数要匹配.</p>
<h4 id="getXXXField-setXXXField-getStaticXXXField-setStaticXXXField"><a href="#getXXXField-setXXXField-getStaticXXXField-setStaticXXXField" class="headerlink" title="getXXXField / setXXXField / getStaticXXXField /setStaticXXXField"></a>getXXXField / setXXXField / getStaticXXXField /setStaticXXXField</h4><p>有对象引用时这几个方法都可以使用不用区分静态非静态,如果你想获得/设置一个静态字段，又没有对象的引用，你可以使用<code>getStaticXXX</code>和<code>setStaticXXX</code>方法。</p>
<h4 id="getAdditionalXXXField-setAdditionalXXXField"><a href="#getAdditionalXXXField-setAdditionalXXXField" class="headerlink" title="getAdditionalXXXField / setAdditionalXXXField"></a>getAdditionalXXXField / setAdditionalXXXField</h4><p>这些方法让你将任何值与一个对象的实例或是整个类（像是一个静态字段）联系起来。这些值依照关键字-值对的方式存储。所以每个对象可以存储多个值。关键字可以是任何字符串，包括对象实际拥有的字段的名称。请注意你不能通过调用<code>getAdditionalInstanceField</code>获取你之前用<code>setAdditionalStaticField</code>存储的值。取而代之的是应该使用<code>getAdditionalStaticField</code>。它有一个变量来接受对象并自动查询它的类。</p>
<h4 id="assetAsByteArray"><a href="#assetAsByteArray" class="headerlink" title="assetAsByteArray"></a>assetAsByteArray</h4><p>这个方法以byte数组的形式返回资源。如果你想加载你模块的资源，你可以使用以下代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XposedTweakbox</span> <span class="keyword">implements</span> <span class="title">IXposedHookZygoteInit</span> </span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initZygote</span><span class="params">(StartupParam startupParam)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">            Resources tweakboxRes = XModuleResources.createInstance(startupParam.modulePath, <span class="keyword">null</span>);</span><br><span class="line">            <span class="keyword">byte</span>[] crtPatch = assetAsByteArray(tweakboxRes, <span class="string">"crtfix_samsung_d506192d5049a4042fb84c0265edfe42.bsdiff"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="getMD5Sum"><a href="#getMD5Sum" class="headerlink" title="getMD5Sum"></a>getMD5Sum</h4><p>返回文件系统中一个文件的MD5值。需要读取权限</p>
<h4 id="getProcessPid"><a href="#getProcessPid" class="headerlink" title="getProcessPid"></a>getProcessPid</h4><p>按照进程的/proc/[pid]/cmdline的第一部分来寻找这个进程,并以字符串形式返回它的PID。</p>
<h3 id="IXposedHookZygoteInit接口"><a href="#IXposedHookZygoteInit接口" class="headerlink" title="IXposedHookZygoteInit接口"></a>IXposedHookZygoteInit接口</h3><p>要实现<code>public void initZygote(StartupParam startupParam)</code>方法,每次zygote启动时调用<code>StartupParam</code>存放类的路径</p>
<h3 id="IXposedHookLoadPackage接口"><a href="#IXposedHookLoadPackage接口" class="headerlink" title="IXposedHookLoadPackage接口"></a>IXposedHookLoadPackage接口</h3><p>主要hook操作,要实现<code>public abstract void handleLoadPackage(LoadPackageParam lpparam)</code>.每次调用app的包时触发</p>
<h2 id="IDE中使用Xposed-框架"><a href="#IDE中使用Xposed-框架" class="headerlink" title="IDE中使用Xposed  框架"></a>IDE中使用Xposed  框架</h2><p>所在的Xposed 模块都需要引用 Xposed 的jar,框架的公网发布地址是:<a href="https://bintray.com/rovo89/de.robv.android.xposed/api" target="_blank" rel="noopener">https://bintray.com/rovo89/de.robv.android.xposed/api</a></p>
<h3 id="Android-Studio"><a href="#Android-Studio" class="headerlink" title="Android Studio"></a>Android Studio</h3><p>在<code>app/build.gradle</code>配置如下:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">repositories &#123;</span><br><span class="line">    jcenter();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    provided &apos;de.robv.android.xposed:api:82&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>使用<code>provided</code>而不用<code>compile</code>的原因是在Android 4.x上会出现问题,使用<code>provided</code>只是维持引用,真正的代码在xposed框架安装时提供.</p>
<h3 id="Eclipse"><a href="#Eclipse" class="headerlink" title="Eclipse"></a>Eclipse</h3><p>如果你使用的是eclipse时你可以从<a href="https://jcenter.bintray.com/de/robv/android/xposed/api/" target="_blank" rel="noopener">https://jcenter.bintray.com/de/robv/android/xposed/api/</a>下载jar.<br>我建议你放到<code>lib</code>目录下,手动添加到库路径,而不是放到<code>libs</code>目录中,因为<code>libs</code>目录中的类eclipse会自动编译API到apk中。</p>
<h3 id="API-版本"><a href="#API-版本" class="headerlink" title="API  版本"></a>API  版本</h3><p>一般情况 下api版本和xposed的版本是一样的, 也尽量保持向下兼容.<br>api 的文档地址:<a href="http://api.xposed.info/" target="_blank" rel="noopener">http://api.xposed.info/</a></p>
<h2 id="替换资源"><a href="#替换资源" class="headerlink" title="替换资源"></a>替换资源</h2><h3 id="简单资源替换"><a href="#简单资源替换" class="headerlink" title="简单资源替换"></a>简单资源替换</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initZygote</span><span class="params">(IXposedHookZygoteInit.StartupParam startupParam)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    XResources.setSystemWideReplacement(<span class="string">"android"</span>, <span class="string">"bool"</span>, <span class="string">"config_unplugTurnsOnScreen"</span>, <span class="keyword">false</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleInitPackageResources</span><span class="params">(InitPackageResourcesParam resparam)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    <span class="comment">// replacements only for SystemUI</span></span><br><span class="line">    <span class="keyword">if</span> (!resparam.packageName.equals(<span class="string">"com.android.systemui"</span>))</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// different ways to specify the resources to be replaced</span></span><br><span class="line">    resparam.res.setReplacement(<span class="number">0x7f080083</span>, <span class="string">"YEAH!"</span>); <span class="comment">// WLAN toggle text. You should not do this because the id is not fixed. Only for framework resources, you could use android.R.string.something</span></span><br><span class="line">    resparam.res.setReplacement(<span class="string">"com.android.systemui:string/quickpanel_bluetooth_text"</span>, <span class="string">"WOO!"</span>);</span><br><span class="line">    resparam.res.setReplacement(<span class="string">"com.android.systemui"</span>, <span class="string">"string"</span>, <span class="string">"quickpanel_gps_text"</span>, <span class="string">"HOO!"</span>);</span><br><span class="line">    resparam.res.setReplacement(<span class="string">"com.android.systemui"</span>, <span class="string">"integer"</span>, <span class="string">"config_maxLevelOfSignalStrengthIndicator"</span>, <span class="number">6</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>简单的替换数据类型支持:  <code>Boolean, Color, Integer, int[], String and String[]</code></p>
<p>全局的资源替换在<code>initZygote</code>中调用<code>XResources.setSystemWideReplacement(...)</code>方法。对于特定app的资源,你需要根据包名判断之后在<code>hookInitPackageResources</code>中调用<code>res.setReplacement</code>。</p>
<p>替换<code>Drawable</code>也大同小异,便要注意的是可能一个<code>Drawable</code>实例被多个<code>ImageView</code>引用,所以要包装一个要替换的<code>Drawable</code><br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">resparam.res.setReplacement(<span class="string">"com.android.systemui"</span>, <span class="string">"drawable"</span>, <span class="string">"status_bar_background"</span>, <span class="keyword">new</span> XResources.DrawableLoader() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Drawable <span class="title">newDrawable</span><span class="params">(XResources res, <span class="keyword">int</span> id)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ColorDrawable(Color.WHITE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="复杂的资源替换"><a href="#复杂的资源替换" class="headerlink" title="复杂的资源替换"></a>复杂的资源替换</h3><p>像动画<code>Drawables</code>这种复杂的资源替换,必须引用到你模块中自带的资源.以替换电池图标为例,代码如下:<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> de.robv.android.xposed.mods.coloredcirclebattery;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.res.XModuleResources;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.IXposedHookInitPackageResources;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.IXposedHookZygoteInit;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.callbacks.XC_InitPackageResources.InitPackageResourcesParam;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ColoredCircleBattery</span> <span class="keyword">implements</span> <span class="title">IXposedHookZygoteInit</span>, <span class="title">IXposedHookInitPackageResources</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String MODULE_PATH = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initZygote</span><span class="params">(StartupParam startupParam)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        MODULE_PATH = startupParam.modulePath;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleInitPackageResources</span><span class="params">(InitPackageResourcesParam resparam)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!resparam.packageName.equals(<span class="string">"com.android.systemui"</span>))</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        XModuleResources modRes = XModuleResources.createInstance(MODULE_PATH, resparam.res);</span><br><span class="line">        resparam.res.setReplacement(<span class="string">"com.android.systemui"</span>, <span class="string">"drawable"</span>, <span class="string">"stat_sys_battery"</span>, modRes.fwd(R.drawable.battery_icon));</span><br><span class="line">        resparam.res.setReplacement(<span class="string">"com.android.systemui"</span>, <span class="string">"drawable"</span>, <span class="string">"stat_sys_battery_charge"</span>, modRes.fwd(R.drawable.battery_icon_charge));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>最简单的做法就是把<code>battery_icon.png</code>,<code>battery_icon_charge.png</code>放到<code>res/drawables</code>目录下，当然你也可以用xml定义一个<code>animation-list</code>.<br>要做资源适配的话,你可以自己准备几套不同分辨率的资源放到res对应的目录里.</p>
<p>上面替换资源的做法对于常规的 app都是有效的.</p>
<h3 id="修改布局"><a href="#修改布局" class="headerlink" title="修改布局"></a>修改布局</h3><p>虽然上面的全局修改资源的方案是可行的,但是多个模块同时修改时还是有竞争问题，而且这样替换资源对于ROM的稳定性不太好.所以我推荐另外一种方案.就是在布局完成后去<code>hook</code><br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleInitPackageResources</span><span class="params">(InitPackageResourcesParam resparam)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!resparam.packageName.equals(<span class="string">"com.android.systemui"</span>))</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    resparam.res.hookLayout(<span class="string">"com.android.systemui"</span>, <span class="string">"layout"</span>, <span class="string">"status_bar"</span>, <span class="keyword">new</span> XC_LayoutInflated() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleLayoutInflated</span><span class="params">(LayoutInflatedParam liparam)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">            TextView clock = (TextView) liparam.view.findViewById(</span><br><span class="line">                    liparam.res.getIdentifier(<span class="string">"clock"</span>, <span class="string">"id"</span>, <span class="string">"com.android.systemui"</span>));</span><br><span class="line">            clock.setTextColor(Color.RED);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>每当<code>status_bar</code>布局被填充后,会回调方法<code>handleLayoutInflated</code>,从回传的<code>LayoutInflatedParam</code>对象中你可以得到<code>View</code>对象,然后就可以对其进行修改了.</p>
<h2 id="奇淫技巧"><a href="#奇淫技巧" class="headerlink" title="奇淫技巧"></a>奇淫技巧</h2><h3 id="Xposed-接管系统所有广播包"><a href="#Xposed-接管系统所有广播包" class="headerlink" title="Xposed 接管系统所有广播包"></a>Xposed 接管系统所有广播包</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">findAndHookMethod(<span class="string">"com.android.server.firewall.IntentFirewall"</span>,</span><br><span class="line">                lpparam.classLoader,</span><br><span class="line">                <span class="string">"checkBroadcast"</span>,</span><br><span class="line">                Intent.class,   <span class="comment">// intent</span></span><br><span class="line">                <span class="keyword">int</span>.class,  <span class="comment">// callerUid</span></span><br><span class="line">                <span class="keyword">int</span>.class,  <span class="comment">// callerPid</span></span><br><span class="line">                String.class,   <span class="comment">// resolvedType</span></span><br><span class="line">                <span class="keyword">int</span>.class,  <span class="comment">// receivingUid</span></span><br><span class="line">                <span class="keyword">new</span> XC_MethodHook() &#123;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">beforeHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                <span class="keyword">int</span> callerUid = (<span class="keyword">int</span>) param.args[<span class="number">1</span>];</span><br><span class="line">                <span class="keyword">int</span> receivingUid = (<span class="keyword">int</span>) param.args[<span class="number">4</span>];</span><br><span class="line">                XposedBridge.log(<span class="string">"hook IntentFirewall.checkBroadcast : "</span> + <span class="string">"broadcast from "</span> + callerUid + <span class="string">" to "</span> + receivingUid);</span><br><span class="line"></span><br><span class="line">                Intent intent = (Intent) param.args[<span class="number">0</span>];</span><br><span class="line">                String action = intent.getAction();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (action == <span class="keyword">null</span>)</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                <span class="keyword">if</span> (action.equals(<span class="string">"android.intent.action.SCREEN_OFF"</span>))</span><br><span class="line">                    XposedBridge.log(<span class="string">"hook IntentFirewall.checkBroadcast : "</span> + <span class="string">"screen off"</span>);</span><br><span class="line">                <span class="keyword">if</span> (action.equals(<span class="string">"android.intent.action.SCREEN_ON"</span>))</span><br><span class="line">                    XposedBridge.log(<span class="string">"hook IntentFirewall.checkBroadcast : "</span> + <span class="string">"screen on"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="嵌套hook监控前台应用"><a href="#嵌套hook监控前台应用" class="headerlink" title="嵌套hook监控前台应用"></a>嵌套hook监控前台应用</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">findAndHookMethod(<span class="string">"com.android.server.net.NetworkPolicyManagerService"</span>,</span><br><span class="line">                lpparam.classLoader,</span><br><span class="line">                <span class="string">"systemReady"</span>,</span><br><span class="line">                <span class="keyword">new</span> XC_MethodHook() &#123;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">beforeHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                XposedBridge.log(<span class="string">"hook NetworkPolicyManagerService.systemReady"</span>);</span><br><span class="line">                XposedBridge.log(<span class="string">"hook NetworkPolicyManagerService.systemReady : "</span> + param.thisObject.getClass());</span><br><span class="line"></span><br><span class="line">                Object mProcessObserverClass = XposedHelpers.getObjectField(param.thisObject, <span class="string">"mProcessObserver"</span>);</span><br><span class="line">                XposedBridge.log(<span class="string">"hook NetworkPolicyManagerService.systemReady : "</span> + mProcessObserverClass.getClass());</span><br><span class="line"></span><br><span class="line">                findAndHookMethod(mProcessObserverClass.getClass(),</span><br><span class="line">                        <span class="string">"onForegroundActivitiesChanged"</span>,</span><br><span class="line">                        <span class="keyword">int</span>.class,  <span class="comment">// pid</span></span><br><span class="line">                        <span class="keyword">int</span>.class,  <span class="comment">// uid</span></span><br><span class="line">                        <span class="keyword">boolean</span>.class, <span class="comment">// foregroundActivities</span></span><br><span class="line">                        <span class="keyword">new</span> XC_MethodHook() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">afterHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                        <span class="keyword">if</span> ((<span class="keyword">boolean</span>) param.args[<span class="number">2</span>])</span><br><span class="line">                            XposedBridge.log(<span class="string">"hook NetworkPolicyManagerService.onForegroundActivitiesChanged : foreground uid = "</span> + param.args[<span class="number">1</span>]);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="xposed进程读取文件"><a href="#xposed进程读取文件" class="headerlink" title="xposed进程读取文件"></a>xposed进程读取文件</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.idhyt.xposedExtend;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Environment;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.json.JSONException;</span><br><span class="line"><span class="keyword">import</span> org.json.JSONObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.SELinuxHelper;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.services.FileResult;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Created by idhyt on 2015/12/10.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This class is used to read file from data/data/xxx/files directory,</span></span><br><span class="line"><span class="comment"> * same as XSharedPreferences, read-only and without listeners support.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XFiles</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="string">"XFiles"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> File mFile;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String mFilename;</span><br><span class="line">    <span class="keyword">private</span> ByteArrayOutputStream mFileOutputStream;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> mLoaded = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> mLastModified;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> mFileSize;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Read settings from the specified file.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> file The file to read.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">XFiles</span><span class="params">(File file)</span> </span>&#123;</span><br><span class="line">        mFile = file;</span><br><span class="line">        mFilename = mFile.getAbsolutePath();</span><br><span class="line">        startLoadFromDisk();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> packageName The package name.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">XFiles</span><span class="params">(String packageName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(packageName, packageName + <span class="string">"_files"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> packageName The package name.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fileName The file name with suffix (.txt, .json, etc..)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">XFiles</span><span class="params">(String packageName, String fileName)</span> </span>&#123;</span><br><span class="line">        mFile = <span class="keyword">new</span> File(Environment.getDataDirectory(), <span class="string">"data/"</span> + packageName + <span class="string">"/files/"</span> + fileName);</span><br><span class="line">        mFilename = mFile.getAbsolutePath();</span><br><span class="line">        startLoadFromDisk();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Tries to make the files file world-readable.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * This will only work if executed as root (e.g. &#123;<span class="doctag">@code</span> initZygote()&#125;) and only if SELinux is disabled.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; in case the file could be made world-readable.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">makeWorldReadable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!SELinuxHelper.getAppDataFileService().hasDirectFileAccess())</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>; <span class="comment">// It doesn't make much sense to make the file readable if we wouldn't be able to access it anyway.</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!mFile.exists()) <span class="comment">// Just in case - the file should never be created if it doesn't exist.</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> mFile.setReadable(<span class="keyword">true</span>, <span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the file that is backing these preferences.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;&lt;strong&gt;Warning:&lt;/strong&gt; The file might not be accessible directly.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> File <span class="title">getFile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mFile;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startLoadFromDisk</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">            mLoaded = <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">new</span> Thread(<span class="string">"XFiles-load"</span>) &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">synchronized</span> (XFiles.<span class="keyword">this</span>) &#123;</span><br><span class="line">                    loadFromDiskLocked();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(&#123; <span class="string">"rawtypes"</span>, <span class="string">"unchecked"</span> &#125;)</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">loadFromDiskLocked</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (mLoaded) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ByteArrayOutputStream fileOutputStream = <span class="keyword">null</span>;</span><br><span class="line">        ByteArrayOutputStream byteArrayOutputStream = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">        FileResult fileResult = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fileResult = SELinuxHelper.getAppDataFileService().getFileInputStream(mFilename, mFileSize, mLastModified);</span><br><span class="line">            InputStream inputStream = fileResult.stream;</span><br><span class="line">            <span class="keyword">if</span> (inputStream != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">int</span> length = inputStream.available();</span><br><span class="line">                <span class="keyword">byte</span> [] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[length];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">int</span> readLength;</span><br><span class="line">                <span class="keyword">while</span> ((readLength = inputStream.read(buffer)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                    byteArrayOutputStream.write(buffer, <span class="number">0</span>, readLength);</span><br><span class="line">                &#125;</span><br><span class="line">                fileOutputStream = byteArrayOutputStream;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException ignored) &#123;</span><br><span class="line">            <span class="comment">// SharedPreferencesImpl has a canRead() check, so it doesn't log anything in case the file doesn't exist</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            Log.w(TAG, <span class="string">"getSharedPreferences"</span>, e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (fileResult != <span class="keyword">null</span> &amp;&amp; fileResult.stream != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    fileResult.stream.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (RuntimeException rethrown) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> rethrown;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception ignored) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        mLoaded = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (fileOutputStream != <span class="keyword">null</span>) &#123;</span><br><span class="line">            mFileOutputStream = fileOutputStream;</span><br><span class="line">            mLastModified = fileResult.mtime;</span><br><span class="line">            mFileSize = fileResult.size;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            mFileOutputStream = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">        &#125;</span><br><span class="line">        notifyAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Reload the settings from file if they have changed.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;&lt;strong&gt;Warning:&lt;/strong&gt; With enforcing SELinux, this call might be quite expensive.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true if execute reload;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">boolean</span> <span class="title">reload</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (hasFileChanged()) &#123;</span><br><span class="line">            startLoadFromDisk();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Check whether the file has changed since the last time it has been loaded.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;&lt;strong&gt;Warning:&lt;/strong&gt; With enforcing SELinux, this call might be quite expensive.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">boolean</span> <span class="title">hasFileChanged</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            FileResult result = SELinuxHelper.getAppDataFileService().statFile(mFilename);</span><br><span class="line">            <span class="keyword">return</span> mLastModified != result.mtime || mFileSize != result.size;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException ignored) &#123;</span><br><span class="line">            <span class="comment">// SharedPreferencesImpl doesn't log anything in case the file doesn't exist</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            Log.w(TAG, <span class="string">"hasFileChanged"</span>, e);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">awaitLoadedLocked</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (!mLoaded) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                wait();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException unused) &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getFileContent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">            awaitLoadedLocked();</span><br><span class="line">            <span class="keyword">return</span> mFileOutputStream.toString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JSONObject <span class="title">getJsonFileContent</span><span class="params">()</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> JSONObject(getFileContent());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>###判断xposed框架是否生效</p>
<ol>
<li>首先我们生成一个配置文件setting.xml</li>
<li><p>定义一个函数</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setXposedStatus</span><span class="params">(<span class="keyword">boolean</span> bStatus)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.getSharedPreferences(<span class="string">"setting"</span>, Context.MODE_WORLD_READABLE).edit().putBoolean(<span class="string">"xposed_enabled"</span>, bStatus).apply();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>应用每次启动时候调用函数setXposedStatus</p>
</li>
<li>在xposed中hook函数setXposedStatus调用前，并将参数改为true</li>
</ol>
<p>这样我们要想知道xposed框架是否生效可用，读取setting.xml中xposed_enabled字段值即可。</p>
<p><a href="http://www.infoq.com/cn/articles/android-in-depth-xposed" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/android-in-depth-xposed</a><br><a href="http://blog.idhyt.com/2015/11/28/android-injection-xposed-usage/" target="_blank" rel="noopener">http://blog.idhyt.com/2015/11/28/android-injection-xposed-usage/</a></p>

      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/xposed/" rel="tag"># xposed</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/reStructuredText简明语法/" rel="next" title="reStructuredText简明语法">
                <i class="fa fa-chevron-left"></i> reStructuredText简明语法
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/微信开发调试/" rel="prev" title="微信开发调试">
                微信开发调试 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">farwmarth</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">99</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">34</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">76</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/wujiyu115" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.litefeel.com" title="litefeel" target="_blank">litefeel</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://learndocs.farwmarth.com/" title="学习笔记" target="_blank">学习笔记</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#xposed-概念"><span class="nav-number">1.</span> <span class="nav-text">xposed 概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#xposed-原理"><span class="nav-number">2.</span> <span class="nav-text">xposed 原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#zygote-受精卵"><span class="nav-number">2.1.</span> <span class="nav-text">zygote (受精卵)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#xposed-工作原理"><span class="nav-number">2.2.</span> <span class="nav-text">xposed 工作原理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Xposed-module"><span class="nav-number">3.</span> <span class="nav-text">Xposed module</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#添加元数据"><span class="nav-number">3.1.</span> <span class="nav-text">添加元数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实现模块接口"><span class="nav-number">3.2.</span> <span class="nav-text">实现模块接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#asserts中xposed-init-入口点声明"><span class="nav-number">3.3.</span> <span class="nav-text">asserts中xposed_init 入口点声明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hook-a-method"><span class="nav-number">3.4.</span> <span class="nav-text">hook a method</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Xposed-手册"><span class="nav-number">4.</span> <span class="nav-text">Xposed 手册</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#XposedBridge类"><span class="nav-number">4.1.</span> <span class="nav-text">XposedBridge类</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#log"><span class="nav-number">4.1.1.</span> <span class="nav-text">log</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#hookAllMethods-hookAllConstructors"><span class="nav-number">4.1.2.</span> <span class="nav-text">hookAllMethods / hookAllConstructors</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XposedHelpers类"><span class="nav-number">4.2.</span> <span class="nav-text">XposedHelpers类</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#findMethod-findConstructor-findField"><span class="nav-number">4.2.1.</span> <span class="nav-text">findMethod / findConstructor / findField</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#callMethod-callStaticMethod-newInstance"><span class="nav-number">4.2.2.</span> <span class="nav-text">callMethod / callStaticMethod / newInstance</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#getXXXField-setXXXField-getStaticXXXField-setStaticXXXField"><span class="nav-number">4.2.3.</span> <span class="nav-text">getXXXField / setXXXField / getStaticXXXField /setStaticXXXField</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#getAdditionalXXXField-setAdditionalXXXField"><span class="nav-number">4.2.4.</span> <span class="nav-text">getAdditionalXXXField / setAdditionalXXXField</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#assetAsByteArray"><span class="nav-number">4.2.5.</span> <span class="nav-text">assetAsByteArray</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#getMD5Sum"><span class="nav-number">4.2.6.</span> <span class="nav-text">getMD5Sum</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#getProcessPid"><span class="nav-number">4.2.7.</span> <span class="nav-text">getProcessPid</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IXposedHookZygoteInit接口"><span class="nav-number">4.3.</span> <span class="nav-text">IXposedHookZygoteInit接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IXposedHookLoadPackage接口"><span class="nav-number">4.4.</span> <span class="nav-text">IXposedHookLoadPackage接口</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IDE中使用Xposed-框架"><span class="nav-number">5.</span> <span class="nav-text">IDE中使用Xposed  框架</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Android-Studio"><span class="nav-number">5.1.</span> <span class="nav-text">Android Studio</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Eclipse"><span class="nav-number">5.2.</span> <span class="nav-text">Eclipse</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#API-版本"><span class="nav-number">5.3.</span> <span class="nav-text">API  版本</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#替换资源"><span class="nav-number">6.</span> <span class="nav-text">替换资源</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简单资源替换"><span class="nav-number">6.1.</span> <span class="nav-text">简单资源替换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#复杂的资源替换"><span class="nav-number">6.2.</span> <span class="nav-text">复杂的资源替换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#修改布局"><span class="nav-number">6.3.</span> <span class="nav-text">修改布局</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#奇淫技巧"><span class="nav-number">7.</span> <span class="nav-text">奇淫技巧</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Xposed-接管系统所有广播包"><span class="nav-number">7.1.</span> <span class="nav-text">Xposed 接管系统所有广播包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#嵌套hook监控前台应用"><span class="nav-number">7.2.</span> <span class="nav-text">嵌套hook监控前台应用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#xposed进程读取文件"><span class="nav-number">7.3.</span> <span class="nav-text">xposed进程读取文件</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2011 &mdash; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">farwmarth</span>

  

  
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动 v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Gemini</a> v6.2.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.2.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.2.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.2.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.2.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.2.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.2.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.2.0"></script>



  



	





  





  










  





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
