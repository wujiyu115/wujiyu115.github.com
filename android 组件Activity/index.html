<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">



  <meta name="description" content="android 组件Activity"/>




  <meta name="keywords" content="android, farwmarth" />










  <link rel="alternate" href="/atom.xml" title="farwmarth">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.6.0" />



<link rel="canonical" href="http://www.farwmarth.com/android 组件Activity/"/>


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.6.0" />






  



  <script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>









    <title> android 组件Activity - farwmarth </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">farwmarth</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/about">
        <li class="mobile-menu-item">
          
          
            关于
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            归档
          
        </li>
      </a>
    
      <a href="/tags">
        <li class="mobile-menu-item">
          
          
            标签
          
        </li>
      </a>
    
      <a href="/categories">
        <li class="mobile-menu-item">
          
          
            分类
          
        </li>
      </a>
    
      <a href="/douban">
        <li class="mobile-menu-item">
          
          
            豆瓣
          
        </li>
      </a>
    
      <a href="/music">
        <li class="mobile-menu-item">
          
          
            音乐
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">farwmarth</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            
            
              关于
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              归档
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            
            
              标签
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/categories">
            
            
              分类
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/douban">
            
            
              豆瓣
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/music">
            
            
              音乐
            
          </a>
        </li>
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          android 组件Activity
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2013-04-05
        </span>
        
          <div class="post-category">
            
              <a href="/categories/android/">android</a>
            
          </div>
        
        
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一-Acvitivity"><span class="toc-text">一 Acvitivity</span></a></li></ol>
    </div>
  </div>


    <div class="post-content">
      
        <p>Android开发四大组件分别是：</p>
<ul>
<li>活动（Activity)： 用于表现功能。</li>
<li>服务（Service)： 后台运行服务，不提供界面呈现。</li>
<li>广播接收器（BroadcastReceiver)：用于接收广播。</li>
<li>数据实体（Content Provider）： 支持在多个应用中存储和读取数据，相当于数据库</li>
</ul>
<a id="more"></a>
<h2 id="一-Acvitivity"><a href="#一-Acvitivity" class="headerlink" title="一 Acvitivity"></a>一 Acvitivity</h2><p>Activity 是用户唯一可以看得到的东西。Activity主要负责的就是创建显示窗口，你可以在这些窗口里使用setContentView(View)来显示你自己的UI。activity展现在用户面前的经常是全屏窗口，你也可以将activity作为浮动窗口来使用（使用设置了windowIsFloating的主题），或者嵌入到其他的activity（使用ActivityGroup）中。<br>**Activity的四种状态:</p>
<ul>
<li><strong>Active/Runing</strong>: 一个新 Activity 启动入栈后，它在屏幕最前端，处于栈的最顶端，此时它处于可见并可和用户交互的激活状态。</li>
<li><strong>Paused</strong>: 当 Activity 被另一个透明或者 Dialog 样式的 Activity 覆盖时的状态。此时它依然与窗口管理器保持连接，系统继续维护其内部状态，所以它仍然可见，但它已经失去了焦点故不可与用户交互。</li>
<li><strong>Stoped</strong>: 当 Activity 被另外一个 Activity 覆盖、失去焦点并不可见时处于 Stoped 状态。</li>
<li><strong>Destroyed</strong>: Activity 被系统杀死回收或者没有被启动时处于 Killed 状态。<br><a href="http://farwmarth.bestnewbee.com/images/uploads/2013/04/201104291036314498.png" target="_blank" rel="noopener">201104291036314498</a><br>官方给的生命周期图，意思差不多:<br><img src="http://farwmarth.bestnewbee.com/images/uploads/2013/04/activity_lifecycle.png" alt="activity_lifecycle"></li>
</ul>
<p><strong>方法何时被调用:</strong></p>
<ul>
<li><strong>onCreate ：</strong>当活动第一次启动的时候，触发该方法，<font color="#ff0000">可以在此时完成活动的初始化工作.</font><br>onCreate 方法有一个参数，该参数可以为空（ null ），也可以是之前调用 onSaveInstanceState （）方法保存的状态信息。</li>
<li><strong>onStart ：</strong> 在启动或从stoped状态重新启动时调用，所以初始化工作不应该放在这里，比如socket连接之类的。</li>
<li><strong>onResume</strong> : 启动,paused到running状态，stoped到running状态.</li>
<li><strong>onPause ：</strong>当一个正在前台运行的活动因为其他的活动需要前台运行而转入后台运行的时候，触发该方法。这时候需要<font color="#ff0000">将活动的状态持久化</font>，比如正在编辑的数据库记录等。</li>
<li><strong>onStop ：</strong>当一个活动不再需要展示给用户的时候，触发该方法。如果内存紧张，系统会直接结束这个活动，而不会触发 onStop 方法。 所以保存状态信息是应该在onPause时做，而不是onStop时做。活动如果没有在前台运行，都将被停止或者Linux管理进程为了给新的活动预留足够的存储空间而随时结束这些活动。因此对于开发者来说，在设计应用程序的时候，必须时刻牢记这一原则。在一些情况下，onPause方法或许是活动触发的最后的方法，因此开发者需要在这个时候保存需要保存的信息。</li>
<li><strong>onRestart ：</strong>stoped到running状态，触发该方法。</li>
<li><strong>onDestroy ：</strong>当活动销毁的时候，触发该方法。和 onStop 方法一样，如果内存紧张，系统会直接结束这个活动而不会触发该方法。</li>
<li><strong>onSaveInstanceState ：</strong>系统调用该方法，允许活动保存之前的状态，比如说在一串字符串中的光标所处的位置等。通常情况下，开发者不需要重写覆盖该方法，在默认的实现中，已经提供了自动保存活动所涉及到的用户界面组件的所有状态信息。</li>
</ul>
<p><strong>Activity栈:</strong></p>
<p>Android 是通过一种 Activity 栈的方式来管理 Activity 的，一个 Activity 的实例的状态决定它在栈中的位置。处于前台的 Activity 总是在栈的顶端，当前台的 Activity 因为异常或其它原因被销毁时，处于栈第二层的 Activity 将被激活，上浮到栈顶。当新的 Activity 启动入栈时，原 Activity 会被压入到栈的第二层。一个 Activity 在栈中的位置变化反映了它在不同状态间的转换。Activity 的状态与它在栈中的位置关系如下图所示：<br><img src="http://farwmarth.bestnewbee.com/images/uploads/2013/04/image002.jpg" alt="image002"></p>
<p>除了最顶层即处在 Active 状态的 Activity 外，其它的 Activity 都有可能在系统内存不足时被回收，一个 Activity 的实例越是处在栈的底层，它被系统回收的可能性越大。系统负责管理栈中 Activity 的实例，它根据 Activity 所处的状态来改变其在栈中的位置。</p>
<p><strong>Activity 之间通信</strong></p>
<ol>
<li><p><strong> 使用Intent通信 </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 发送</span></span><br><span class="line">Intent intent = <span class="keyword">new</span> Intent(EX06.<span class="keyword">this</span>, OtherActivity.class);</span><br><span class="line">intent.putExtra(<span class="string">"boolean_key"</span>, <span class="keyword">true</span>);</span><br><span class="line">intent.putExtra(<span class="string">"string_key"</span>, <span class="string">"string_value"</span>);</span><br><span class="line">startActivity(intent);</span><br><span class="line"><span class="comment">// 接收</span></span><br><span class="line">Intent intent = getIntent();</span><br><span class="line">intent.getBooleanExtra(<span class="string">"boolean_key"</span>, <span class="keyword">false</span>);</span><br><span class="line">intent.getStringExtra(<span class="string">"string_key"</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用 SharedPreferences<br>SharedPreferences 使用 xml 格式为 Android 应用提供一种永久的数据存贮方式。对于一个 Android 应用，它存贮在文件系统的 /data/ data/your_app_package_name/shared_prefs/目录下，可以被处在同一个应用中的所有 Activity 访问。Android 提供了相关的 API 来处理这些数据而不需要程序员直接操作这些文件或者考虑数据同步问题。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="number">2</span>:           SharedPreferences preferences = getSharedPreferences(<span class="string">"name"</span>, MODE_PRIVATE); </span><br><span class="line"> <span class="number">3</span>:           Editor editor = preferences.edit(); </span><br><span class="line"> <span class="number">4</span>:           editor.putBoolean(<span class="string">"boolean_key"</span>, <span class="keyword">true</span>); </span><br><span class="line"> <span class="number">5</span>:           editor.putString(<span class="string">"string_key"</span>, <span class="string">"string_value"</span>); </span><br><span class="line"> <span class="number">6</span>:           editor.commit(); </span><br><span class="line"> <span class="number">8</span>:           <span class="comment">// 读取 SharedPreferences </span></span><br><span class="line"> <span class="number">9</span>:           SharedPreferences preferences = getSharedPreferences(<span class="string">"name"</span>, MODE_PRIVATE); </span><br><span class="line"><span class="number">10</span>:           preferences.getBoolean(<span class="string">"boolean_key"</span>, <span class="keyword">false</span>); </span><br><span class="line"><span class="number">11</span>:           preferences.getString(<span class="string">"string_key"</span>, <span class="string">"default_value"</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>其它方式<br>Android 提供了包括 SharedPreferences 在内的很多种数据存贮方式，比如 SQLite，文件等，程序员可以通过这些 API 实现 Activity 之间的数据交换。如果必要，我们还可以使用 IPC 方式。</p>
</li>
</ol>
<p><strong>Activity启动模式</strong>：</p>
<ul>
<li>Application、task、Activity三者之间的关系:<br><img src="http://farwmarth.bestnewbee.com/images/uploads/2013/04/201104290925106332.png" alt="201104290925106332"></li>
</ul>
<p>Android为了使我们能够打破默认的堆栈的先后出的模式，提供了两个种方式：一种是在AndroidManifest.xml定义Activity时指定它的加载模式，另一种是在用Intent开启一个Activity时，在Intent中加入标志。如果两种方式都用了，则后者的优先级更高</p>
<ol>
<li>standard<br>“拿来主义”standard模式。哪里需要调用我我就去哪里，可以多次实例化，可以几个相同的Activity重叠。(系统默认)</li>
<li>singleTop<br>“拒绝堆叠”singleTop模式。可以多次实例化，但是不可以多个相同的Activity重叠，当堆栈的顶部为相同的Activity时，会调用onNewIntent函数。</li>
<li>singleTask<br>独立门户”singleTask模式。同一个应用中调用该Activity时，如果该Activity没有被实例化，会在本应用程序的Task内实例化，如果已经实例化，会将Task中其上的Activity销毁后，调用onNewIntent；其它应用程序调用该Activity时，如果该Activity没有被实例化，会创建新的Task并实例化后入栈，如果已经实例化，会销毁其上的Activity，并调用onNewIntent。一句话，singleTask就是“独立门户”，在自己的Task里，并且启动时不允许其他Activity凌驾于自己之上。 </li>
<li><p>singleInstance<br>孤独寂寞”singleInstance模式。加载该Activity时如果没有实例化，他会创建新的Task后，实例化入栈，如果已经存在，直接调用onNewIntent，该Activity的Task中不允许启动其它的Activity，任何从该Activity启动的其他Activity都将被放到其他task中，先检查是否有本应用的task，没有的话就创建。</p>
<p>在androidmainfest.xml中设置：android:launchMode=”standard”</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span></span></span><br><span class="line"><span class="tag">             <span class="attr">android:name</span>=<span class="string">"com.example.studyandroidcode.MainActivity"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">android:label</span>=<span class="string">"@string/app_name"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">android:launchMode</span>=<span class="string">"standard"</span> &gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"android.intent.action.MAIN"</span> /&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.LAUNCHER"</span> /&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>参考</p>
</li>
</ol>
<p><a href="http://www.cnblogs.com/ghj1976/archive/2011/04/29/2032495.html" target="_blank" rel="noopener">http://www.cnblogs.com/ghj1976/archive/2011/04/29/2032495.html</a><br><a href="http://www.ibm.com/developerworks/cn/opensource/os-cn-android-actvt/" target="_blank" rel="noopener">http://www.ibm.com/developerworks/cn/opensource/os-cn-android-actvt/</a><br><a href="http://winuxxan.blog.51cto.com/2779763/504047" target="_blank" rel="noopener">http://winuxxan.blog.51cto.com/2779763/504047</a><br><a href="http://www.blogjava.net/marshal-hird/archive/2008/07/25/217389.html" target="_blank" rel="noopener">http://www.blogjava.net/marshal-hird/archive/2008/07/25/217389.html</a></p>

      
    </div>

    
      
      



      
      
  <div class="post-reward">
    <input type="checkbox" name="reward" id="reward" hidden />
    <label class="reward-button" for="reward">赞赏支持</label>
    <div class="qr-code">
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="/image/reward/wechat.png" title="wechat">
        </label>
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="/image/reward/alipay.png" title="alipay">
        </label>
      
    </div>
  </div>

    

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/android/">android</a>
            
          </div>
        
        
        
  <nav class="post-nav">
    
      <a class="prev" href="/android 反编译和代码解读/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">android 反编译和代码解读</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    
    
      <a class="next" href="/android框架结构/">
        <span class="next-text nav-default">android　框架结构</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
  </div>


        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:wujiyu115@email.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a href="http://github.com/wujiyu115" class="iconfont icon-github" title="github"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a href="/farwmwarth" class="iconfont icon-instagram" title="instagram"></a>
        
      
    
    
    
      <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>


<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2011 - 
    
    2018

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">farwmarth</span>
  </span>
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  
  

  



    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  


    <script type="text/javascript" src="/js/src/even.js?v=2.6.0"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.6.0"></script>

  </body>
</html>
